# passportdetect

В этом проекте обучается модель, предсказывающа опасность астероида.

Конфигурации каждого этапа хранятся в папке `configs`.

## Инициализация проекта

```shell
poetry install
```

## Запуск севера MLFlow

```shell
poetry run mlflow server --host 127.0.0.1 --port 8080
```

## Обучение

```shell
poetry run python3 passport_detect/train.py
```

## Тестирование

```shell
poetry run python3 passport_detect/infer.py
```

## Запуск сервера

Сервер запускается по адресу `http://localhost:5000/`.

```shell
poetry run python3 passport_detect/run_server.py
```

### Обращение к серверу

Сервер принимает POST запросы по адресу `http://localhost:5000/predict`.

В тело запроса передаются данные в формате JSON.

Пример:

```
{"inputs": [[0,3703080,3703080,21.6,0.1272198785,0.2844722965,127.2198785394,284.4722965033,0.0790507431,0.1767628354,417.3880663071,933.3080892598,788947200000,6.1158343887,22017.003799315,13680.5099440799,0.4194825299,163.1787109375,62753692.0,38993336.0,17,5,0.0252819,4.634,2458000.5,0.4255490832802685,1.407011302712976,6.025981287138329,314.3739134134077,609.599786407648,0.808258932678493,57.25746987539545,2.005763672747459,2458161.6417204863,264.8375332988031,0.5905513880204395]]}
```

Сервер возвращает ответ в формате JSON.
Пример:

```
{"outputs":[[0.9983733892440796,0.0016266102902591228]]}
```

Пример запроса:

```shell
curl http://127.0.0.1:5000/predict -H 'Content-Type: application/json' -d '{"inputs": [[0,3703080,3703080,21.6,0.1272198785,0.2844722965,127.2198785394,284.4722965033,0.0790507431,0.1767628354,417.3880663071,933.3080892598,788947200000,6.1158343887,22017.003799315,13680.5099440799,0.4194825299,163.1787109375,62753692.0,38993336.0,17,5,0.0252819,4.634,2458000.5,0.4255490832802685,1.407011302712976,6.025981287138329,314.3739134134077,609.599786407648,0.808258932678493,57.25746987539545,2.005763672747459,2458161.6417204863,264.8375332988031,0.5905513880204395]]}'
```

```shell
curl http://127.0.0.1:5000/predict -H 'Content-Type: application/json' -d '{"inputs": [[62932, 11.9, 41.6, 0, 7.6, 12.6, 43, 7, 31, 71, 19, 1015.2, 1011.8, 0, 1, 21.6, 38.7, 0], [120383, 13.5, 20.8, 0.8, 3.4, 8.6, 50, 28, 30, 64, 48, 1012.3, 1010.9, 7, 7, 18.3, 19.3, 0]]}'
```
