# passportdetect

В этом проекте обучается модель, предсказывающа опасность астероида.

Конфигурации каждого этапа хранятся в папке `configs`.

## Инициализация проекта

```shell
poetry install
```

## Запуск севера MLFlow

```shell
poetry run mlflow server --host 127.0.0.1 --port 8080
```

## Обучение

```shell
poetry run python3 passport_detect/train.py
```

## Тестирование

```shell
poetry run python3 passport_detect/infer.py
```

## Запуск сервера

Сервер запускается по адресу `http://localhost:5000/`.

```shell
poetry run python3 passport_detect/run_server.py
```

### Обращение к серверу

Сервер принимает POST запросы по адресу `http://localhost:5000/predict`.

В тело запроса передаются данные в формате JSON.

Пример:

```
{"inputs": [[0,3703080,3703080,21.6,0.1272198785,0.2844722965,127.2198785394,284.4722965033,0.0790507431,0.1767628354,417.3880663071,933.3080892598,788947200000,6.1158343887,22017.003799315,13680.5099440799,0.4194825299,163.1787109375,62753692.0,38993336.0,17,5,0.0252819,4.634,2458000.5,0.4255490832802685,1.407011302712976,6.025981287138329,314.3739134134077,609.599786407648,0.808258932678493,57.25746987539545,2.005763672747459,2458161.6417204863,264.8375332988031,0.5905513880204395]]}
```

Сервер возвращает ответ в формате JSON.
Пример:

```
{"outputs":[[0.6470586657524109,0.3529414236545563]]}
```

Пример запроса:

```shell
curl http://127.0.0.1:5000/predict -H 'Content-Type: application/json' -d '{"inputs": [[0,3703080,3703080,21.6,0.1272198785,0.2844722965,127.2198785394,284.4722965033,0.0790507431,0.1767628354,417.3880663071,933.3080892598,788947200000,6.1158343887,22017.003799315,13680.5099440799,0.4194825299,163.1787109375,62753692.0,38993336.0,17,5,0.0252819,4.634,2458000.5,0.4255490832802685,1.407011302712976,6.025981287138329,314.3739134134077,609.599786407648,0.808258932678493,57.25746987539545,2.005763672747459,2458161.6417204863,264.8375332988031,0.5905513880204395]]}'
```

```shell
curl http://127.0.0.1:5000/predict -H 'Content-Type: application/json' -d '{"inputs": [[0,3703080,3703080,21.6,0.1272198785,0.2844722965,127.2198785394,284.4722965033,0.0790507431,0.1767628354,417.3880663071,933.3080892598,788947200000,6.1158343887,22017.003799315,13680.5099440799,0.4194825299,163.1787109375,62753692.0,38993336.0,17,5,0.0252819,4.634,2458000.5,0.4255490832802685,1.407011302712976,6.025981287138329,314.3739134134077,609.599786407648,0.808258932678493,57.25746987539545,2.005763672747459,2458161.6417204863,264.8375332988031,0.5905513880204395], [1,3723955,3723955,21.3,0.1460679643,0.3266178974,146.0679642714,326.6178974458,0.090762397,0.2029508896,479.2256199,1071.581062656,788947200000,18.1139850263,65210.3460948409,40519.1731054305,0.3830144627,148.9926300049,57298148.0,35603420.0,21,3,0.186935,5.457,2458000.5,0.3516743045868617,1.10777595443772,28.41299637199041,136.7172416568082,425.8692942066788,0.7181996160227876,313.0919748302692,1.497352292852652,2457794.969431285,173.7411119891742,0.8453297875598617]]}'
```
